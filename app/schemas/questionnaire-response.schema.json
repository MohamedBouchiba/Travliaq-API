{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://travliaq.com/schemas/questionnaire-response.json",
  "title": "Travliaq Travel Questionnaire Response",
  "description": "Sch√©ma complet pour les r√©ponses au questionnaire de voyage Travliaq. Ce questionnaire peut comporter jusqu'√† 24-28 √©tapes selon le parcours de l'utilisateur.",
  "type": "object",
  "required": ["email"],
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Identifiant unique de la r√©ponse (g√©n√©r√© automatiquement)"
    },
    "user_id": {
      "type": ["string", "null"],
      "format": "uuid",
      "description": "ID de l'utilisateur Supabase Auth (null si non authentifi√© au moment de la soumission)"
    },
    "email": {
      "type": "string",
      "format": "email",
      "maxLength": 255,
      "description": "Email de l'utilisateur (obligatoire)",
      "examples": ["jean.dupont@example.com"]
    },
    "travel_group": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Qui voyage ? (√âtape 1)",
      "enum": [
        "Solo",
        "En duo",
        "Groupe (3-5)",
        "En famille",
        null
      ],
      "examples": ["En famille", "Solo"]
    },
    "number_of_travelers": {
      "type": ["integer", "null"],
      "minimum": 1,
      "maximum": 50,
      "description": "Nombre exact de voyageurs (√âtape 1b - conditionnel si Famille ou Groupe 3-5)",
      "examples": [4, 2]
    },
    "has_destination": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Destination en t√™te ? (√âtape 2)",
      "enum": ["Oui", "Non", "Yes", "No", null],
      "examples": ["Oui", "Non"]
    },
    "destination": {
      "type": ["string", "null"],
      "maxLength": 200,
      "description": "Destination choisie (√âtape 2c - si has_destination = Oui)",
      "examples": [
        "Paris, France üá´üá∑",
        "Tokyo, Japon üáØüáµ",
        "New York, √âtats-Unis üá∫üá∏"
      ]
    },
    "departure_location": {
      "type": ["string", "null"],
      "maxLength": 200,
      "description": "Lieu de d√©part (√âtape 2c - si has_destination = Oui)",
      "examples": [
        "Lyon, France üá´üá∑",
        "Londres, Royaume-Uni üá¨üáß"
      ]
    },
    "climate_preference": {
      "type": ["array", "null"],
      "description": "Pr√©f√©rences climatiques (√âtape 2d - si has_destination = Non, choix multiples)",
      "items": {
        "type": "string",
        "maxLength": 200,
        "enum": [
          "Chaud et ensoleill√©",
          "Doux et temp√©r√©",
          "Froid et neige",
          "Tropical et humide",
          "Montagne et altitude",
          "Peu importe"
        ]
      },
      "maxItems": 6,
      "uniqueItems": true,
      "examples": [
        ["Chaud et ensoleill√©", "Tropical et humide"],
        ["Peu importe"]
      ]
    },
    "travel_affinities": {
      "type": ["array", "null"],
      "description": "Affinit√©s de voyage (√âtape 2e - si has_destination = Non, max 5)",
      "items": {
        "type": "string",
        "maxLength": 200,
        "enum": [
          "Plages paradisiaques",
          "Villes historiques",
          "Nature & randonn√©es",
          "Ski & sports d'hiver",
          "Safari & animaux",
          "Gastronomie locale",
          "Shopping & mode",
          "Festivals & √©v√©nements",
          "Architecture moderne",
          "Temples & spiritualit√©",
          "Parcs d'attractions",
          "Plong√©e & snorkeling",
          "Road trip & libert√©",
          "Vignobles & ≈ìnologie",
          "D√©serts & paysages lunaires",
          "√éles & archipels"
        ]
      },
      "maxItems": 5,
      "uniqueItems": true,
      "examples": [
        ["Plages paradisiaques", "Gastronomie locale", "Nature & randonn√©es"]
      ]
    },
    "travel_ambiance": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Ambiance recherch√©e (√âtape 2f - si has_destination = Non)",
      "enum": [
        "D√©tente totale",
        "Aventure & d√©couverte",
        "Culture & patrimoine",
        "F√™te & vie nocturne",
        "Nature & ressourcement",
        null
      ],
      "examples": ["Aventure & d√©couverte", "D√©tente totale"]
    },
    "dates_type": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Type de dates (√âtape 3)",
      "enum": ["Dates fixes", "Dates flexibles", null],
      "examples": ["Dates flexibles"]
    },
    "departure_date": {
      "type": ["string", "null"],
      "format": "date",
      "description": "Date de d√©part (√âtape 3b - si dates_type = Dates fixes)",
      "examples": ["2025-07-15"]
    },
    "return_date": {
      "type": ["string", "null"],
      "format": "date",
      "description": "Date de retour (√âtape 3b - si dates_type = Dates fixes)",
      "examples": ["2025-07-22"]
    },
    "flexibility": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Flexibilit√© des dates (√âtape 3c - si dates_type = Dates flexibles)",
      "enum": [
        "¬±1 jour",
        "¬±2-3 jours",
        "¬±1 semaine",
        "Totalement flexible",
        null
      ],
      "examples": ["¬±2-3 jours", "Totalement flexible"]
    },
    "has_approximate_departure_date": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Date de d√©part approximative ? (√âtape 3d - si dates_type = Dates flexibles)",
      "enum": ["Oui", "Non", "Yes", "No", null],
      "examples": ["Oui"]
    },
    "approximate_departure_date": {
      "type": ["string", "null"],
      "format": "date",
      "description": "Date approximative (√âtape 3e - si has_approximate_departure_date = Oui)",
      "examples": ["2025-08-01"]
    },
    "duration": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Dur√©e du s√©jour (√âtape 4 - si dates_type = Dates flexibles)",
      "enum": [
        "2 nuits",
        "3 nuits",
        "4 nuits",
        "5 nuits",
        "6 nuits",
        "7 nuits",
        "8 √† 10 nuits",
        "11 √† 14 nuits",
        "+14 nuits",
        null
      ],
      "examples": ["7 nuits", "11 √† 14 nuits"]
    },
    "exact_nights": {
      "type": ["integer", "null"],
      "minimum": 15,
      "maximum": 365,
      "description": "Nombre exact de nuits (√âtape 4b - si duration = +14 nuits)",
      "examples": [21, 30]
    },
    "budget": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Budget par personne (√âtape 5 - hors vols)",
      "enum": [
        "Je ne sais pas",
        "Montant pr√©cis",
        "Moins de 300‚Ç¨",
        "300-600‚Ç¨",
        "600-900‚Ç¨",
        "900-1200‚Ç¨",
        "1200-1800‚Ç¨",
        "Plus de 1800‚Ç¨",
        null
      ],
      "examples": ["600-900‚Ç¨", "Plus de 1800‚Ç¨"]
    },
    "budget_type": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Type de budget (√âtape 5 - si budget = Montant pr√©cis)",
      "enum": ["Montant pr√©cis", null],
      "examples": ["Montant pr√©cis"]
    },
    "budget_amount": {
      "type": ["number", "null"],
      "minimum": 0,
      "maximum": 10000000,
      "description": "Montant exact du budget (√âtape 5b - si budget_type = Montant pr√©cis)",
      "examples": [2500, 1200.50]
    },
    "budget_currency": {
      "type": ["string", "null"],
      "maxLength": 50,
      "description": "Devise du budget (√âtape 5b - si budget_type = Montant pr√©cis)",
      "enum": ["EUR", "USD", "GBP", null],
      "examples": ["EUR", "USD"]
    },
    "styles": {
      "type": ["array", "null"],
      "description": "Styles de voyage (√âtape 6 - max 5, si has_destination = Oui ET activit√©s s√©lectionn√©es)",
      "items": {
        "type": "string",
        "maxLength": 200,
        "enum": [
          "Nature & randonn√©es",
          "Culture & mus√©es",
          "Gastronomie",
          "Plage & farniente",
          "Montagne & altitude",
          "Spots photo",
          "March√©s locaux",
          "Sport & plein air",
          "Bien-√™tre & spa",
          "Vie nocturne"
        ]
      },
      "maxItems": 5,
      "uniqueItems": true,
      "examples": [
        ["Nature & randonn√©es", "Gastronomie", "Plage & farniente"]
      ]
    },
    "rhythm": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Rythme du voyage (√âtape 7 - si activit√©s s√©lectionn√©es)",
      "enum": [
        "Cool (2-3h d'activit√©s/jour)",
        "√âquilibr√© (4-6h d'activit√©s/jour)",
        "Intense (7h+ d'activit√©s/jour)",
        null
      ],
      "examples": ["√âquilibr√© (4-6h d'activit√©s/jour)"]
    },
    "flight_preference": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Pr√©f√©rence de vols (√âtape 8 - si vols s√©lectionn√©s)",
      "enum": [
        "Uniquement vol direct",
        "Max 1 escale",
        "Peu importe (prix avant tout)",
        null
      ],
      "examples": ["Max 1 escale"]
    },
    "luggage": {
      "type": ["object", "null"],
      "description": "Bagages par voyageur (√âtape 9 - si vols s√©lectionn√©s). Cl√© = index voyageur, Valeur = type de bagage",
      "patternProperties": {
        "^[0-9]+$": {
          "type": "string",
          "enum": [
            "Cabine uniquement",
            "1 bagage en soute",
            "2 bagages en soute"
          ]
        }
      },
      "examples": [
        {
          "0": "Cabine uniquement",
          "1": "1 bagage en soute"
        }
      ]
    },
    "mobility": {
      "type": ["array", "null"],
      "description": "Mobilit√© et besoins (√âtape 10 - choix multiples)",
      "items": {
        "type": "string",
        "maxLength": 200,
        "enum": [
          "Aucun probl√®me de mobilit√©",
          "Mobilit√© r√©duite (fauteuil roulant)",
          "Mobilit√© limit√©e (canne, d√©ambulateur)",
          "Besoin d'ascenseurs",
          "√âviter les escaliers",
          "Voyageur avec b√©b√©/enfant en bas √¢ge"
        ]
      },
      "maxItems": 6,
      "uniqueItems": true,
      "examples": [
        ["Aucun probl√®me de mobilit√©"],
        ["Besoin d'ascenseurs", "√âviter les escaliers"]
      ]
    },
    "accommodation_type": {
      "type": ["array", "null"],
      "description": "Types d'h√©bergement (√âtape 11 - si h√©bergement s√©lectionn√©, choix multiples)",
      "items": {
        "type": "string",
        "maxLength": 100,
        "enum": [
          "H√¥tel",
          "Appartement/Airbnb",
          "Maison d'h√¥tes",
          "Auberge de jeunesse",
          "Resort all-inclusive",
          "Camping/Glamping"
        ]
      },
      "maxItems": 6,
      "uniqueItems": true,
      "examples": [
        ["H√¥tel", "Appartement/Airbnb"]
      ]
    },
    "comfort": {
      "type": ["string", "null"],
      "maxLength": 100,
      "description": "Niveau de confort (√âtape 12 - si h√©bergement s√©lectionn√©)",
      "enum": [
        "Note ‚â•7,5/10",
        "Note ‚â•8,0/10",
        "Note ‚â•8,5/10",
        "Peu importe",
        null
      ],
      "examples": ["Note ‚â•8,0/10"]
    },
    "neighborhood": {
      "type": ["string", "null"],
      "maxLength": 200,
      "description": "Type de quartier (√âtape 13 - si h√©bergement s√©lectionn√©)",
      "enum": [
        "Calme et reposant",
        "Centre-ville anim√©",
        "Proche nature/plage",
        "Atypique et charmant",
        null
      ],
      "examples": ["Centre-ville anim√©", "Proche nature/plage"]
    },
    "amenities": {
      "type": ["array", "null"],
      "description": "√âquipements souhait√©s (√âtape 14 - si h√©bergement s√©lectionn√©, choix multiples)",
      "items": {
        "type": "string",
        "maxLength": 200,
        "enum": [
          "Wi-Fi fiable",
          "Climatisation",
          "Cuisine √©quip√©e",
          "Lave-linge",
          "Parking",
          "Ascenseur",
          "R√©ception 24h/24",
          "Proche lieu de culte",
          "Lit b√©b√©",
          "Chambre familiale",
          "Piscine",
          "Salle de sport",
          "Spa",
          "Jardin/Terrasse"
        ]
      },
      "maxItems": 14,
      "uniqueItems": true,
      "examples": [
        ["Wi-Fi fiable", "Climatisation", "Piscine"]
      ]
    },
    "constraints": {
      "type": ["array", "null"],
      "description": "Contraintes et pr√©f√©rences alimentaires/religieuses (√âtape 15 - choix multiples)",
      "items": {
        "type": "string",
        "maxLength": 200,
        "enum": [
          "Nourriture halal",
          "Nourriture casher",
          "V√©g√©tarien",
          "V√©g√©talien (vegan)",
          "Sans gluten",
          "Sans porc",
          "Sans alcool",
          "Lieux de pri√®re √† proximit√©",
          "Traditions bouddhistes",
          "Accessibilit√© PMR",
          "Zones s√ªres (LGBTQ+, femmes...)",
          "√âviter la voiture",
          "Respecter traditions locales",
          "Allergies alimentaires",
          "Peu importe"
        ]
      },
      "maxItems": 15,
      "uniqueItems": true,
      "examples": [
        ["Nourriture halal", "Sans alcool"],
        ["V√©g√©tarien", "Sans gluten"],
        ["Peu importe"]
      ]
    },
    "additional_info": {
      "type": ["string", "null"],
      "maxLength": 2000,
      "description": "Informations suppl√©mentaires (√âtape 16 - zone de texte libre, optionnelle)"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Date et heure de cr√©ation de la r√©ponse"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "Date et heure de derni√®re modification"
    }
  },
  "dependencies": {
    "number_of_travelers": {
      "description": "Le nombre de voyageurs n'est demand√© que si travel_group est 'En famille' ou 'Groupe (3-5)'",
      "oneOf": [
        {
          "properties": {
            "travel_group": {
              "enum": ["En famille", "Groupe (3-5)"]
            }
          },
          "required": ["number_of_travelers"]
        },
        {
          "properties": {
            "number_of_travelers": {
              "type": "null"
            }
          }
        }
      ]
    },
    "destination": {
      "description": "La destination n'est demand√©e que si has_destination = 'Oui'",
      "oneOf": [
        {
          "properties": {
            "has_destination": {
              "enum": ["Oui", "Yes"]
            }
          },
          "required": ["destination", "departure_location"]
        },
        {
          "properties": {
            "destination": {
              "type": "null"
            },
            "departure_location": {
              "type": "null"
            }
          }
        }
      ]
    },
    "climate_preference": {
      "description": "Les pr√©f√©rences climatiques ne sont demand√©es que si has_destination = 'Non'",
      "oneOf": [
        {
          "properties": {
            "has_destination": {
              "enum": ["Non", "No"]
            }
          },
          "required": ["climate_preference"]
        },
        {
          "properties": {
            "climate_preference": {
              "type": "null"
            }
          }
        }
      ]
    },
    "departure_date": {
      "description": "Les dates pr√©cises ne sont demand√©es que si dates_type = 'Dates fixes'",
      "oneOf": [
        {
          "properties": {
            "dates_type": {
              "const": "Dates fixes"
            }
          },
          "required": ["departure_date", "return_date"]
        },
        {
          "properties": {
            "departure_date": {
              "type": "null"
            },
            "return_date": {
              "type": "null"
            }
          }
        }
      ]
    },
    "duration": {
      "description": "La dur√©e n'est demand√©e que si dates_type = 'Dates flexibles'",
      "oneOf": [
        {
          "properties": {
            "dates_type": {
              "const": "Dates flexibles"
            }
          },
          "required": ["duration"]
        },
        {
          "properties": {
            "duration": {
              "type": "null"
            }
          }
        }
      ]
    },
    "exact_nights": {
      "description": "Le nombre exact de nuits n'est demand√© que si duration = '+14 nuits'",
      "oneOf": [
        {
          "properties": {
            "duration": {
              "const": "+14 nuits"
            }
          },
          "required": ["exact_nights"]
        },
        {
          "properties": {
            "exact_nights": {
              "type": "null"
            }
          }
        }
      ]
    },
    "budget_amount": {
      "description": "Le montant et la devise ne sont demand√©s que si budget_type = 'Montant pr√©cis'",
      "oneOf": [
        {
          "properties": {
            "budget_type": {
              "const": "Montant pr√©cis"
            }
          },
          "required": ["budget_amount", "budget_currency"]
        },
        {
          "properties": {
            "budget_amount": {
              "type": "null"
            },
            "budget_currency": {
              "type": "null"
            }
          }
        }
      ]
    }
  },
  "examples": [],
  "additionalProperties": false
}